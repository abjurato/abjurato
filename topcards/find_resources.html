<!DOCTYPE html><html lang="en"><head><link rel="stylesheet" href="https://abjurato.github.io/general.css" type="text/css"/><title>find resources of an app (on jailbroken device)</title><meta name="twitter:title" content="find resources of an app (on jailbroken device)"/><meta name="og:title" content="find resources of an app (on jailbroken device)"/><meta name="twitter:image" content="https://abjurato.github.io/images/3.jpeg"/><meta name="og:image" content="https://abjurato.github.io/images/3.jpeg"/><meta name="twitter:card" content="summary"/><meta name="description" content="find resources of an app (on jailbroken device)"/><meta name="twitter:description" content="find resources of an app (on jailbroken device)"/><meta name="og:description" content="find resources of an app (on jailbroken device)"/><link rel="canonical" href="https://abjurato.github.io/topcards/find_resources.html"/><meta name="twitter:url" content="https://abjurato.github.io/topcards/find_resources.html"/><meta name="og:url" content="https://abjurato.github.io/topcards/find_resources.html"/></head><body><a href="https://abjurato.github.io/" class="comment">(lldb) thread step-out</a><h1>Find resources of an app (on jailbroken device)</h1><p>An app from AppStore has following places where its stuff can be found:<ol><li>App bundle with executable, resources and extensions<span class="snippet">/var/containers/Bundle/Application</span></li><li>App working directory<span class="snippet">/var/mobile/Containers/Data/Application</span></li><li>App Extensions working directory<span class="snippet">/var/mobile/Containers/Data/PluginKitPlugin</span></li><li>App Groups working directory<span class="snippet">/var/mobile/Containers/Shared/AppGroup</span></li></ol>First one is signed by developer during upload to AppStore, so no one can modify it's contents without re-signing the binary (or breaking codesisning validations). The others are directories for data generated during app lifetime. Each of the directories above has and UUID-named subfolders, where UUID is randomly generated during app installation.<br/>How does the system know which directory belongs to which app then? System service called <span class="inlinecode">LaunchServices</span>does.</p><h2>Caveman methods (1, 2, 3, 4)</h2><p><p>Easiest way - run process explorer <span class="inlinecode"># ps ax | grep &lt;NAME&gt;</span> on iOS side while the app in interest is launched, which will show binary's localtion per process - whether the process is one of app or of app extension.</p><p>List of app groups the app participates in can be found by reading binary's entitlements:<span class="snippet"># ldid -e &lt;PATH-TO-BINARY&gt;</span></p><p>Each of UUID'd folders contains hidden <span class="inlinecode">.com.apple.mobile_container_manager.metadata.plist</span> file which contains either bundle ID or app group ID in <span class="inlinecode">MCMMetadataIdentifier</span> field. So a brave reader can enumerate 1-4 directories and every one of subfolders in them, and search for those with bundleID/appGroupID of interest in the hidden plist.</p><p>Another way for desperate researcher would be to look for LaunchServices database located in a temporary folder under one of <span class="inlinecode">/private/var/containers/Data/System</span> subfolders with a filename similar to <span class="inlinecode">com.apple.LaunchServices-231-v2.csstore</span>. Altho I did not find any way to conveniently read contents of that file apart from running <span class="inlinecode">LSDTrip</span> which is capable of talking to a responsible <span class="inlinecode">lsd</span> launch services daemon on device itself.</p></p><h2>Objection and Frida (1, 2)</h2><p>Task is fully automated by <span class="inlinecode">objection</span> framerwork for <span class="inlinecode">Frida</span>:<ul><li>Connect to <span class="inlinecode">Frida</span> server on device:<span class="snippet">$ itnl --lport 2222 --iport 22</span></li><li>Connect <span class="inlinecode">objection</span> to the app by correct name:<span class="snippet">$ objection --gadget="Telegram" explore</span></li><li>Command <span class="inlinecode">env</span> will output the directories:<div class="gist"><script src="https://gist.github.com/abjurato/1553ca7fa811570a0592892a10090fec.js"></script></div></li></ul></p><h2>LSDTrip (1, 2, 3, 4)</h2><p>Utility called <span class="inlinecode">LSDTrip</span> by Jonathan Levin gives more complete output. It is open source, but installation instructions in [2] are a little bit outdated - as of iOS 12 entitlements should be as follows:<div class="gist"><script src="https://gist.github.com/abjurato/78f2e6b85a475317f04bfd966367c6f8.js"></script></div>and a little bit verbose output of <span class="inlinecode"># ./lsdtrip.arm64 dump</span> will contain <span class="inlinecode">appContainer</span>, <span class="inlinecode">dataContainer</span>, <span class="inlinecode">groups</span><div class="gist"><script src="https://gist.github.com/abjurato/1f8a85aa0f148f2db3bc24cb7d9b2738.js"></script></div> and a list of <span class="inlinecode">plugin Identif</span>iers, each of which has it's own place in the output down below:<div class="gist"><script src="https://gist.github.com/abjurato/4c819634786f4d41b5edb63df1ee22e4.js"></script></div></p><br/><h2>Sources</h2><p><a href="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06b-basic-security-testing#using-objection">[1] OWASP Mobile Security Testing Guide</a></p><p><a href="http://newosxbook.com/tools/lsdtrip.html">[2] LSDTrip - Take a ride down the LaunchServices.framework rabbithole by Jonathan Levin</a></p><br/><div class="comment">Jan 2020, iOS 12.4</div></body></html>