<!DOCTYPE html><html lang="en"><head><link rel="stylesheet" href="https://abjurato.github.io/general.css" type="text/css"/><title>static Mach-O binary analyse</title><meta name="twitter:title" content="static Mach-O binary analyse"/><meta name="og:title" content="static Mach-O binary analyse"/><meta name="twitter:image" content="https://abjurato.github.io/images/4.jpeg"/><meta name="og:image" content="https://abjurato.github.io/images/4.jpeg"/><meta name="twitter:card" content="summary"/><meta name="description" content="static Mach-O binary analyse"/><meta name="twitter:description" content="static Mach-O binary analyse"/><meta name="og:description" content="static Mach-O binary analyse"/><link rel="canonical" href="https://abjurato.github.io/topcards/static_macho_analyse.html"/><meta name="twitter:url" content="https://abjurato.github.io/topcards/static_macho_analyse.html"/><meta name="og:url" content="https://abjurato.github.io/topcards/static_macho_analyse.html"/></head><body><a href="https://abjurato.github.io/" class="comment">(lldb) thread step-out</a><h1>Static Mach-O binary analyse</h1><h2>macOS side</h2><p><ul><li><span class="inlinecode">$ file &lt;BINARY&gt;</span> - will tell the type of file</li><li><span class="inlinecode">$ codesign -dv &lt;BINARY&gt;</span> - verify code signature</li><li><span class="inlinecode">$ codesign -d --entitlements - &lt;BINARY&gt;</span> - defalut way to get entitlements</li><li><span class="inlinecode">$ ./jtool2 --ent &lt;BINARY&gt;</span> - another way to get entitlements</li><li><span class="inlinecode">$ pagestuff &lt;BINARY&gt; -a</span> - sections and segments in Mach-O</li><li><span class="inlinecode">$ nm -m &lt;BINARY&gt;</span> - another way to get some info from sections and segments</li><li><span class="inlinecode">$ otool -L &lt;BINARY&gt;</span> - dylibs that binary links to</li><li><span class="inlinecode">$ otool -l &lt;BINARY&gt;</span> - all load commands</li><li><span class="inlinecode">$ otool -l &lt;BINARY&gt; | grep crypt</span> - information about encrypted blob</li><li><span class="inlinecode">$ ./jtool2 -e &lt;SECTION&gt;.&lt;SEGMENT&gt; &lt;BINARY&gt;</span> - extract section/segment into separate file</li><li><span class="inlinecode">$ strings - &lt;BINARY&gt;</span> - all C stirngs</li><li><span class="inlinecode">$ ./class-dump -H -o &lt;DIRECTORY-OUT&gt; &lt;BINARY&gt;</span> - dump objc classes headers</li></ul></p><h2>iOS side</h2><h3>binary</h3><p><ul><li><span class="inlinecode"># ldid -e &lt;BINARY&gt;</span> - read entitlements of binary</li><li>+ all <span class="inlinecode">jtool2</span> related from macOS section</li></ul></p><h3>resources</h3><p><ul><li><span class="inlinecode"># ./FileDP -f/d &lt;FILE/DIRECTORY&gt;</span> - read Data Protection class of file/directory</li></ul></p><br/><h2>Sources</h2><p><a href="http://newosxbook.com/tools/jtool.html">[1] jtool - Taking the O out of otool(1), and so much more by Jonathan Levin</a></p><p><a href="https://go.sentinelone.com/ebook-macos-reversing-malware-registration.html">[2] How to reverse malware on macOS without getting infected by Phil Stokes</a></p><p><a href="https://github.com/abjurato/FileDp-Source">[3] my fork of FileDP by @satishb3 sutable for iOS 12.4</a></p><p><a href="https://github.com/nygard/class-dump">[4] class-dump sources, you will need to rebuild them for 64bit to run on macOS Catalina</a></p><br/><div class="comment">Jan 2020</div></body></html>